{% extends 'template_home.html' %}

{% load staticfiles %}

{% block titulo %}Producci贸n{% endblock %}

{% block contenido %}

    <main>
        <div class="container">
            <a class="waves-effect waves-light btn #2e7d32 green darken-3"   href=""><i class="material-icons right">add_circle</i>Agregar</a>
            <br>
            <br>
            <h3>Caja de costos</h3>
            <div class="divider"></div>
            {% if object_list %}
                <table class="striped centered responsive-table">
                    <thead>
                    <tr>
                        <th data-field="numero">No orden</th>
                        <th data-field="MPUsada">MP utilizada</th>
                        <th data-field="mod">Mano de obra D.</th>
                        <th data-field="CIF">Costos indirectos F.</th>
                        <th data-field="CAT">Costo Art. terminado</th>
                        <th data-field="CAT">Art. terminados Disp.</th>
                        <th data-field="CAT">Costo de lo vendido</th>
                    </tr>
                    </thead>
                    <tbody>


                    {%for producto in object_list%}
                        <tr>
                            <td>{{producto.ordenDeFabricacion.numOrden}}</td>
                            <td>${{producto.ordenDeFabricacion.totalMP|floatformat:"2"}}</td>
                            <td>${{producto.ordenDeFabricacion.totalMOD|floatformat:"2"}}</td>
                            <td>${{producto.ordenDeFabricacion.importe|floatformat:"2"}}</td>
                            <td>${{producto.costoArtTerminado|floatformat:"2"}}</td>
                            <td>${{producto.artTerDisp|floatformat:"2"}}</td>
                            <td>${{producto.costoVendido|floatformat:"2"}}</td>
                        </tr>
                    {%endfor%}

                        <tr style="color: #ff5018;font-weight: 800;">
                            <td>Total</td>
                            <td id="cdc_total_totalMP">${{ totalMP|floatformat:"2" }}</td>
                            <td id="cdc_total_totalMOD">${{ totalMOD|floatformat:"2" }}</td>
                            <td id="cdc_total_importe">${{ importe|floatformat:"2" }}</td>
                            <td id="cdc_total_costoArtTerminado">${{ costoArtTerminado|floatformat:"2" }}</td>
                            <td id="cdc_total_artTerDisp">${{ artTermDisp|floatformat:"2" }}</td>
                            <td id="cdc_total_costoVendido">${{ costoVendido|floatformat:"2" }}</td>
                        </tr>


                    </tbody>
                </table>

                    <br>
                    <br>
                    <h5 class="bold">Orden de Fabricaci贸n vs. Costo de lo Vendido</h5>

                <div class="divider"></div>
                <p>Costo de lo vendido</p>
                <canvas id="chart1" width="200" height="70"></canvas>
                <script>
                    var ctx = document.getElementById("chart1");
                    var chart1 = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels: [
                                {% for producto in object_list %}
                                    "{{ producto.ordenDeFabricacion.numOrden}}",
                                {% endfor %}],
                            datasets: [{
                                label: 'Costo',

                                data: [
                                    {% for producto in object_list%}
                                        {{producto.costoVendido}},
                                    {% endfor %}],
                                backgroundColor:'rgba(0, 128, 0, 0.2)',
                                borderColor: 'rgba(0, 128, 0,1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero: true
                                    }
                                }]
                            }
                        }
                    });
                </script>
                <p class="center">Ordenes de fabricaci贸n</p>

                <h3>Costos Unitarios</h3>
                <div class="divider"></div>
                <table class="striped centered responsive-table">
                <thead>
                <tr>
                    <th data-field="numero">No orden</th>
                    <th data-field="nombre">Producto</th>
                    <th data-field="CAT">Costo de lo vendido</th>
                    <th data-field="cantidad">Cantidad de Productos</th>
                    <th data-field="CU">Costo Unitario</th>
                </tr>
                </thead>
                <tbody>


                {%for producto in object_list%}
                    <tr>
                        <td>{{producto.ordenDeFabricacion.numOrden}}</td>
                        <td>{{producto.nombre}}</td>
                        <td>${{producto.costoVendido|floatformat:"2"}}</td>
                        <td>{{producto.nuneroArticulos}}</td>
                        <td>${{producto.costoUnitario|floatformat:"2"}}</td>
                    </tr>
                {%endfor%}
                </tbody>
                </table>

                <br>

                <h5>Producto vs. Precio</h5>

                <div class="divider"></div>
                <p>Costo unitario</p>
                <canvas id="chart2" width="200" height="70"></canvas>
                <script>
                    var ctx = document.getElementById("chart2");
                    var chart2 = new Chart(ctx, {
                        type: 'bar',
                        data: {
                            labels : [
                                {% for producto in object_list %}
                                    "{{ producto.nombre}}",
                                {% endfor %}],
                            datasets: [{
                                label: 'Costo Unitario',
                                data:  [
                                    {% for producto in object_list%}
                                        {{producto.costoUnitario}},
                                    {% endfor %}],
                                backgroundColor:'rgba(128, 0, 0, 0.2)',
                                borderColor: 'rgba(128,0,0,1)',
                                borderWidth: 1
                            }]
                        },
                        options: {
                            scales: {
                                yAxes: [{
                                    ticks: {
                                        beginAtZero:true
                                    }
                                }]
                            }
                        }
                    });
                </script>

                <p class="center">Producto</p>
            {% else %}
                <h5>No hay producci贸n</h5>
            {% endif %}
        </div>
    </main>
{% endblock %}